<!doctype html>
<html>
<head>
<meta charset="utf-8">
<style>
h1,
h2,
h3,
h4,
h5,
h6,
p,
blockquote {
    margin: 0;
    padding: 0;
}
body {
    font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", Arial, sans-serif;
    font-size: 13px;
    line-height: 18px;
    color: #737373;
    margin: 10px 13px 10px 13px;
}
table {
	margin: 10px 0 15px 0;
	border-collapse: collapse;
}
td,th {	
	border: 1px solid #ddd;
	padding: 3px 10px;
}
th {
	padding: 5px 10px;	
}

a {
    color: #0069d6;
}
a:hover {
    color: #0050a3;
    text-decoration: none;
}
a img {
    border: none;
}
p {
    margin-bottom: 9px;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    color: #404040;
    line-height: 36px;
}
h1 {
    margin-bottom: 18px;
    font-size: 30px;
}
h2 {
    font-size: 24px;
}
h3 {
    font-size: 18px;
}
h4 {
    font-size: 16px;
}
h5 {
    font-size: 14px;
}
h6 {
    font-size: 13px;
}
hr {
    margin: 0 0 19px;
    border: 0;
    border-bottom: 1px solid #ccc;
}
blockquote {
    padding: 13px 13px 21px 15px;
    margin-bottom: 18px;
    font-family:georgia,serif;
    font-style: italic;
}
blockquote:before {
    content:"\201C";
    font-size:40px;
    margin-left:-10px;
    font-family:georgia,serif;
    color:#eee;
}
blockquote p {
    font-size: 14px;
    font-weight: 300;
    line-height: 18px;
    margin-bottom: 0;
    font-style: italic;
}
code, pre {
    font-family: Monaco, Andale Mono, Courier New, monospace;
}
code {
    background-color: #fee9cc;
    color: rgba(0, 0, 0, 0.75);
    padding: 1px 3px;
    font-size: 12px;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
}
pre {
    display: block;
    padding: 14px;
    margin: 0 0 18px;
    line-height: 16px;
    font-size: 11px;
    border: 1px solid #d9d9d9;
    white-space: pre-wrap;
    word-wrap: break-word;
}
pre code {
    background-color: #fff;
    color:#737373;
    font-size: 11px;
    padding: 0;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:10px auto;
    }
}
@media print {
	body,code,pre code,h1,h2,h3,h4,h5,h6 {
		color: black;
	}
}
</style>
<title>Alloy Widget: Drawer</title>
</head>
<body>
<p><img src="./img/Alloy.png" alt="Alloy Icon" /></p>

<h1>Alloy Widget: Drawer</h1>

<h2>Overview</h2>

<p>The <strong>Drawer</strong> widget provides a sliding panel of buttons to pull up from the bottom of the screen. As an option, the drawer can automatically close after it has been used. On Android, the drawer manifests itself as the activity menu, unless the developer wants to specifically override that capability.</p>

<p><img src="./img/ios_closed.png" alt="iOS Drawer Closed" />
<img src="./img/ios_open.png" alt="iOS Drawer Closed" /></p>

<p><img src="./img/android_overridemenu_false.png" alt="Android Activity Menu Version" />
<img src="./img/android_overridemenu_true.png" alt="Android Drawer Version" /></p>

<h2>Manifest</h2>

<ul>
<li>Version: 1.0 (stable)</li>
<li>Github: https://www.github.com/appcelerator/alloy</li>
<li>License: <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0</a></li>
<li>Author: Carl Orthlieb</li>
<li>Supported Platforms: iOS, Android, Mobile Web</li>
</ul>


<h2>Adding the Drawer Widget to Your Alloy Project</h2>

<ul>
<li>In your application&rsquo;s config.json file you will want to include the following line in your dependencies:</li>
</ul>


<pre><code>"dependencies": {
    "com.appcelerator.drawer":"1.0"
}
</code></pre>

<ul>
<li>If the app/widgets directory doesn&rsquo;t exist in your app then create one.</li>
<li>Copy the drawer folder from the test app (widget_drawer/app/widgets) into your app/widgets directory.</li>
</ul>


<h2>Create a Drawer in the View</h2>

<p>You can add a drawer to a view by <em>requiring</em> the Drawer widget.</p>

<pre><code>&lt;Require type="widget" src="com.appcelerator.drawer" id="drawer"/&gt;
</code></pre>

<p>Assign it an ID that you can use in your controller. E.g. <code>id="drawer"</code> You can now access the drawer via <code>$.drawer</code> in your controller.</p>

<h2>Initializing the Drawer in the Controller</h2>

<p>The drawer doesn&rsquo;t have any buttons in it until you initialize it in your controller. Before you open your window, you will want to call the drawer with the <em>init</em> method. For example:</p>

<pre><code>$.drawer.init({
    mainWindow: $.index,
    buttons: [
        { id: 'One', text: 'One', click: function (e) { alert("One"); } },
        { id: 'Two', text: 'Two',  click: function (e) { alert("Two"); } },    
        { id: 'Three', text: 'Three',  click: function (e) { alert("Three"); } }    
    ],
    autoClose: true,
    gutter: 5
});
</code></pre>

<h3>Required Initialization Parameters</h3>

<table>
<thead>
<tr>
<th> Parameter </th>
<th> Type </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td> mainWindow </td>
<td> <em>TiUIWindow</em> </td>
<td> You must supply a window for your drawer so that it can create menu items for the menu attached to the window&rsquo;s activity on Android. Typically, you&rsquo;ll pass in <code>$.&lt;yourwindowid&gt;</code> If you haven&rsquo;t changed the main window id then the Alloy default will be <code>$.index</code>. </td>
</tr>
<tr>
<td> buttons </td>
<td> <em>array</em> </td>
<td> The buttons array is an array of button objects each of which  describes a button to create in the drawer. </td>
</tr>
</tbody>
</table>


<h4>button Object</h4>

<table>
<thead>
<tr>
<th> Parameter </th>
<th> Type </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td> id </td>
<td> <em>string</em> </td>
<td> Unique id for this item. This id also selects the image icons for this button. The drawer expects to find the image at app/assets/images/&lt;id>Enabled.png and app/assets/images/&lt;id>Disabled.png. Default icon size is 48x48 pixels. </td>
</tr>
<tr>
<td> title </td>
<td> <em>string</em> </td>
<td> The text that describes this button that will appear underneath the icon (Android activity menu version only). </td>
</tr>
<tr>
<td> click </td>
<td> <em>function</em> </td>
<td> <em>Optional.</em> The callback to call when the button is clicked. The function has an event parameter similar to that used for regular buttons. If you don&rsquo;t specify a click callback then the button does nothing. </td>
</tr>
<tr>
<td> enabled </td>
<td> <em>function</em> </td>
<td> <em>Optional.</em> The callback to call to determine whether the button should be enabled. This callback should return true (enabled) or false (disabled). Default is for the buttons to always be enabled. </td>
</tr>
</tbody>
</table>


<h3>Optional Initialization Parameters</h3>

<p>There are number of aspects of the Drawer that you can change, you can include these in your parameters when you call the init method.</p>

<table>
<thead>
<tr>
<th> Parameter </th>
<th> Type </th>
<th> Affects </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td> animationDuration </td>
<td> <em>integer</em> </td>
<td> iOS, MW </td>
<td> The duration, in milliseconds, of the animation to close/open the drawer. Default: <em>500</em> </td>
</tr>
<tr>
<td> autoClose </td>
<td> <em>boolean</em> </td>
<td> iOS, MW </td>
<td> If true, automatically closes the drawer after a button has been pressed. Default: <em>false</em> </td>
</tr>
<tr>
<td> closeOpacity</td>
<td> <em>number</em> </td>
<td> iOS, MW </td>
<td> A number between 0 (transparent) and 1 (opaque) that denotes the opacity of the drawer when it is closed. Default: <em>0.75</em> </td>
</tr>
<tr>
<td> gutter </td>
<td> <em>integer</em> </td>
<td> iOS, MW </td>
<td> The offset, in pixels, used to space buttons from each other in the drawer. Default: <em>0</em> </td>
</tr>
<tr>
<td> iconSize </td>
<td> <em>integer</em> </td>
<td> iOS, MW </td>
<td> Size of the icon, in pixels, to used on buttons in the drawer. Default: <em>48x48</em> </td>
</tr>
<tr>
<td> openOpacity </td>
<td> <em>number</em> </td>
<td> iOS, MW </td>
<td> A number between 0 (transparent) and 1 (opaque) that denotes the opacity of the drawer when it is open. Default: <em>0.9</em> </td>
</tr>
<tr>
<td> overrideMenu </td>
<td> <em>boolean</em> </td>
<td> Android </td>
<td> Override the use of the activity menu in Android and use a drawer like in iOS/MobileWeb. In this case, the above parameters do affect Android. Default: <em>false</em> </td>
</tr>
</tbody>
</table>


<h2>Enabling and Disabling Buttons</h2>

<p>With Android, if overrideMenu is not true, the <code>enable()</code> callback is called automatically before the menu is shown. In all other cases, you will need to explicitly call the drawer&rsquo;s <code>checkEnabled()</code> method in order to get those callbacks to fire.</p>

<p>You should call this function whenever a state change could affect the enable state of buttons in the drawer. For example, if your main window displays a web view and you want to enable some forward/back buttons based on the properties of that web view after it has loaded, you might create the following callback attached to the onLoad event:</p>

<pre><code>function webviewLoad(e) {
    $.index.title = $.webview.evalJS("document.title");
    $.drawer.checkEnabled();
}; 
</code></pre>

<h2>Binding</h2>

<p>Because you are passing in functions to be called when a button is clicked, be aware of your binding. The <em>this</em> object is not the same when the <code>click()</code> and <code>enable()</code> callbacks are called as when they are defined. There are many excellent articles that talk about this issue:</p>

<ul>
<li><a href="http://www.alistapart.com/articles/getoutbindingsituations/">Getting Out of Binding Situations in JavaScript</a></li>
<li><a href="http://fitzgeraldnick.com/weblog/26/">Javascript, &ldquo;bind&rdquo;, and &ldquo;this&rdquo;</a></li>
<li><a href="http://www.robertsosinski.com/2009/04/28/binding-scope-in-javascript/">Binding Scope in JavaScript</a></li>
</ul>


<p>It&rsquo;s recommended that you use the underscore library&rsquo;s <a href="http://underscorejs.org/#bind">bind</a> function to bind your callbacks when needed.</p>

<pre><code>$.drawer.init({
    buttons: [
        { id: 'Fancy', text: 'Fancy', click: 
            _.bind(function FancyClick(e) { alert(this.one); }, this) 
        }
    ]
});
</code></pre>

<h2>Future Work</h2>

<p>There are lots of features that can be added to the Drawer:</p>

<ul>
<li>Allowing the drawer to sit on the left, right, or top of the view instead of just the bottom.</li>
<li>Different animations for the drawer like sliding content out of the way instead of overlaying the drawer on top of the content.</li>
<li>Ability to style buttons with more than just a background image.</li>
<li>Support for views besides just a button bar to be hosted in the drawer.</li>
</ul>


<h2>Attributions</h2>

<ul>
<li>Many thanks to Tony and Russ for enduring my numerous silly questions about Alloy.</li>
<li>Appcelerator is an incredible place to work: full of passion and dedication bar none. My thanks to Jeff and Nolan for creating an amazing company.</li>
</ul>

</body>
</html>